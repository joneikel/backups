let $data=document.getElementById("datos");let $cedula=$data.getAttribute("cedula"),$date=$data.getAttribute("date"),$firstname=$data.getAttribute("firstname"),$direction=$data.getAttribute("direction"),$estado=$data.getAttribute("estado"),$municipio=$data.getAttribute("municipio"),$lastname=$data.getAttribute("lastname"),$city=$data.getAttribute("city"),$country=$data.getAttribute("country"),$course=$data.getAttribute("course"),$telefono=$data.getAttribute("telefono"),$area=$data.getAttribute("area"),$programa=$data.getAttribute("programa"),$aula=$data.getAttribute("aula"),$rol=$data.getAttribute("rol"),$red=$data.getAttribute("red");let $applet=parameters1.material_id;console.log($applet);let obj_master={};let $applets={};let jsonObjects=[];function ggbOnInit(params){eval(params).getAppletObject().registerObjectClickListener("botonC",()=>btnCambio(params));eval(params).getAppletObject().registerObjectClickListener("botonEnviar",()=>stateValidation(params));obj_master[params]={casillas:string_arr(eval(params).getAppletObject().getValueString("casillas")+""),};$applets[params]=setEjercicios(params)}
function btnCambio(data){obj_master[data].casillas.forEach(function(element,index){$applets[data]["ejercicio_"+String(index+1)].contadorGeneral+=1;$applets[data]["ejercicio_"+String(index+1)].contadorBtnCambiar+=1;console.log($applets)})}
function stateValidation(data){setTimeout(()=>{let correctas=getCorrectas(data);let casillas=string_arr(eval(data).getAppletObject().getValueString("casillas")+"");if(String(obj_master[data].casillas)!==String(casillas)){obj_master[data].casillas.forEach(function(element,index){if(element!=casillas[index]){$applets[data]["ejercicio_"+String(index+1)].contadorGeneral+=1;$applets[data]["ejercicio_"+String(index+1)].contadorBtnEnviar+=1;if(correctas[index]==1){$applets[data]["ejercicio_"+String(index+1)].correctas+=1}else{$applets[data]["ejercicio_"+String(index+1)].incorrectas+=1}}})}
obj_master[data].casillas=casillas;console.log($applets)},10)}
function string_arr(tex){tex=tex.replace(new RegExp("[, ]","g"),"");tex=tex.replace(new RegExp("[}]","g"),"");if(tex.match(new RegExp("{{","g"))){tex=tex.split("{");tex.splice(0,2)}else{tex=tex.split("{");tex.splice(0,1)}
return tex}
function getCorrectas(name){let correctas=eval(name).getAppletObject().getValueString("correctas"+"").replace(/[^0-9\.]+/g,"");correctas=correctas.split("").map(Number);return correctas}
function setEjercicios(params){let applet=eval(params).getParameters().material_id;let obj={};let correctas=getCorrectas(params);correctas.forEach((correctas,index)=>{obj["ejercicio_"+String(index+1)]={nombre:$firstname,apellido:$lastname,cedula:$cedula,curso:$course,estado:$estado,pais:$country,ciudad:$city,fechaNacimineto:$date,municipio:$municipio,direccion:$direction,telefono:$telefono,area:$area,programa:$programa,aula:$aula,rol:$rol,red:$red,applet:$applet,ejercicio:index+1,correctas:0,incorrectas:0,contadorBtnEnviar:0,contadorBtnCambiar:0,contadorGeneral:0,}});return obj}
let $next=document.getElementById("next-activity-link");let $prev=document.getElementById("prev-activity-link");let aux=!0;$next.addEventListener("click",(e)=>{e.preventDefault();if(aux===!1){return console.log("éxito")}
aux=!1;let url=e.target.getAttribute("href");e.target.removeAttribute("href");if($applet){for(const key in $applets){for(const ele in $applets[key]){postAppletData("http://unerg.alcaravan.com.ve:81/applet01",$applets[key][ele]).then((response)=>{window.location.replace(url)}).catch((e)=>{window.location.replace(url)})}}}else{window.location.replace(url)}},!1);$prev.addEventListener("click",(e)=>{e.preventDefault();if(aux===!1){return console.log("éxito")}
aux=!1;let url=e.target.getAttribute("href");e.target.removeAttribute("href");if($applet){for(const key in $applets){for(const ele in $applets[key]){postAppletData("http://unerg.alcaravan.com.ve:81/applet01",$applets[key][ele]).then((response)=>{window.location.replace(url)}).catch((e)=>{window.location.replace(url)})}}}else{window.location.replace(url)}},!1);async function postAppletData(url,data){let myHeaders=new Headers();myHeaders.append("Content-Type","application/json");const myInit={method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:myHeaders,redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(data),};let myRequest=new Request(url,myInit);const response=await fetch(myRequest);return response.json()}